create or replace function pgunaccent(str text)
returns text
returns null on null input
immutable
as $$
declare
 i           int; 
 cp          int;
 first       int;
 last        int;
 middle      int;
 val         int;
 found       boolean;
 result      text := '';
 -- Table based on unicode descriptions
 arr_convert int[][] := array[[192,65],[193,65],[194,65],[195,65],[196,65],
[197,65],[199,67],[200,69],[201,69],[202,69],[203,69],[204,73],
[205,73],[206,73],[207,73],[209,78],[210,79],[211,79],[212,79],
[213,79],[214,79],[216,79],[217,85],[218,85],[219,85],[220,85],
[221,89],[224,97],[225,97],[226,97],[227,97],[228,97],[229,97],
[231,99],[232,101],[233,101],[234,101],[235,101],[236,105],[237,105],
[238,105],[239,105],[241,110],[242,111],[243,111],[244,111],[245,111],
[246,111],[248,111],[249,117],[250,117],[251,117],[252,117],[253,121],
[255,121],[256,65],[257,97],[258,65],[259,97],[260,65],[261,97],[262,67],
[263,99],[264,67],[265,99],[266,67],[267,99],[268,67],[269,99],[270,68],
[271,100],[272,68],[273,100],[274,69],[275,101],[276,69],[277,101],
[278,69],[279,101],[280,69],[281,101],[282,69],[283,101],[284,71],[285,103],
[286,71],[287,103],[288,71],[289,103],[290,71],[291,103],[292,72],[293,104],
[294,72],[295,104],[296,73],[297,105],[298,73],[299,105],[300,73],[301,105],
[302,73],[303,105],[304,73],[308,74],[309,106],[310,75],[311,107],[313,76],
[314,108],[315,76],[316,108],[317,76],[318,108],[319,76],[320,108],[321,76],
[322,108],[323,78],[324,110],[325,78],[326,110],[327,78],[328,110],[332,79],
[333,111],[334,79],[335,111],[336,79],[337,111],[340,82],[341,114],[342,82],
[343,114],[344,82],[345,114],[346,83],[347,115],[348,83],[349,115],[350,83],
[351,115],[352,83],[353,115],[354,84],[355,116],[356,84],[357,116],[358,84],
[359,116],[360,85],[361,117],[362,85],[363,117],[364,85],[365,117],[366,85],
[367,117],[368,85],[369,117],[370,85],[371,117],[372,87],[373,119],[374,89],
[375,121],[376,89],[377,90],[378,122],[379,90],[380,122],[381,90],[382,122],
[384,98],[385,66],[386,66],[387,98],[391,67],[392,99],[394,68],[395,68],
[396,100],[401,70],[402,102],[403,71],[407,73],[408,75],[409,107],[410,108],
[413,78],[414,110],[415,79],[416,79],[417,111],[420,80],[421,112],[427,116],
[428,84],[429,116],[430,84],[431,85],[432,117],[434,86],[435,89],[436,121],
[437,90],[438,122],[442,658],[446,662],[452,497],[453,68],[454,499],[456,76],
[459,78],[461,65],[462,97],[463,73],[464,105],[465,79],[466,111],[467,85],
[468,117],[469,85],[470,117],[471,85],[472,117],[473,85],[474,117],[475,85],
[476,117],[478,65],[479,97],[480,65],[481,97],[482,198],[483,230],[484,71],
[485,103],[486,71],[487,103],[488,75],[489,107],[490,79],[491,111],[492,79],
[493,111],[494,439],[495,658],[496,106],[498,68],[500,71],[501,103],[504,78],
[505,110],[506,65],[507,97],[508,198],[509,230],[510,79],[511,111],[512,65],
[513,97],[514,65],[515,97],[516,69],[517,101],[518,69],[519,101],[520,73],
[521,105],[522,73],[523,105],[524,79],[525,111],[526,79],[527,111],[528,82],
[529,114],[530,82],[531,114],[532,85],[533,117],[534,85],[535,117],[536,83],
[537,115],[538,84],[539,116],[542,72],[543,104],[544,78],[545,100],[548,90],
[549,122],[550,65],[551,97],[552,69],[553,101],[554,79],[555,111],[556,79],
[557,111],[558,79],[559,111],[560,79],[561,111],[562,89],[563,121],[564,108],
[565,110],[566,116],[570,65],[571,67],[572,99],[573,76],[574,84],[575,115],
[576,122],[579,66],[582,69],[583,101],[584,74],[585,106],[587,113],[588,82],
[589,114],[590,89],[591,121],[595,98],[597,99],[598,100],[599,100],[602,601],
[605,604],[607,567],[608,103],[614,104],[615,42791],[616,105],[619,108],
[620,108],[621,108],[624,623],[625,109],[626,110],[627,110],[634,633],
[635,633],[636,114],[637,114],[638,114],[642,115],[644,567],[646,643],
[648,116],[651,118],[656,122],[657,122],[659,658],[667,610],[669,106],
[672,113],[673,660],[677,675],[686,613],[687,613],[689,688],[693,692],
[902,913],[904,917],[905,919],[906,921],[908,927],[910,933],[911,937],
[912,953],[938,921],[939,933],[940,945],[941,949],[942,951],[943,953],
[944,965],[970,953],[971,965],[972,959],[973,965],[974,969],[1024,1045],
[1037,1048],[1104,1077],[1117,1080],[1142,1140],[1143,1141],[1148,1120],
[1149,1121],[1162,1049],[1163,1081],[1166,1056],[1167,1088],[1168,1043],
[1169,1075],[1170,1043],[1171,1075],[1172,1043],[1173,1075],[1174,1046],
[1175,1078],[1176,1047],[1177,1079],[1178,1050],[1179,1082],[1180,1050],
[1181,1082],[1182,1050],[1183,1082],[1186,1053],[1187,1085],[1190,1055],
[1191,1087],[1194,1057],[1195,1089],[1196,1058],[1197,1090],[1200,1198],
[1201,1199],[1202,1061],[1203,1093],[1206,1063],[1207,1095],[1208,1063],
[1209,1095],[1214,1212],[1215,1213],[1217,1046],[1218,1078],[1219,1050],
[1220,1082],[1221,1051],[1222,1083],[1223,1053],[1224,1085],[1225,1053],
[1226,1085],[1229,1052],[1230,1084],[1232,1040],[1233,1072],[1234,1040],
[1235,1072],[1238,1045],[1239,1077],[1242,1240],[1243,1241],[1244,1046],
[1245,1078],[1246,1047],[1247,1079],[1250,1048],[1251,1080],[1252,1048],
[1253,1080],[1254,1054],[1255,1086],[1258,1256],[1259,1257],[1260,1069],
[1261,1101],[1262,1059],[1263,1091],[1264,1059],[1265,1091],[1266,1059],
[1267,1091],[1268,1063],[1269,1095],[1270,1043],[1271,1075],[1272,1067],
[1273,1099],[1274,1043],[1275,1075],[1276,1061],[1277,1093],[1278,1061],
[1279,1093],[1298,1051],[1299,1083],[1312,1051],[1313,1083],[1314,1053],
[1315,1085],[1316,1055],[1317,1087],[1318,1210],[1319,1211],[1320,1053],
[1321,1085],[1326,1051],[1327,1083],[1570,1575],[1571,1575],[1572,1608],
[1573,1575],[1574,1610],[1595,1705],[1596,1705],[1597,1740],[1598,1740],
[1599,1740],[1650,1575],[1651,1575],[1655,1735],[1660,1578],[1661,1578],
[1665,1581],[1666,1581],[1669,1581],[1673,1583],[1674,1583],[1675,1583],
[1679,1583],[1680,1583],[1682,1585],[1683,1585],[1684,1585],[1685,1585],
[1686,1585],[1687,1585],[1689,1585],[1690,1587],[1691,1587],[1692,1587],
[1693,1589],[1694,1589],[1695,1591],[1696,1593],[1698,1601],[1699,1601],
[1701,1601],[1703,1602],[1704,1602],[1707,1603],[1708,1603],[1710,1603],
[1712,1711],[1714,1711],[1716,1711],[1717,1604],[1718,1604],[1719,1604],
[1720,1604],[1721,1606],[1724,1606],[1725,1606],[1727,1670],[1728,1607],
[1730,1729],[1732,1608],[1738,1608],[1741,1610],[1742,1610],[1743,1608],
[1745,1610],[1747,1746],[1774,1583],[1775,1585],[1786,1588],[1787,1590],
[1788,1594],[1791,1607],[1872,1576],[1873,1576],[1874,1576],[1875,1576],
[1876,1576],[1877,1576],[1878,1576],[1879,1581],[1880,1581],[1881,1583],
[1882,1583],[1883,1585],[1884,1587],[1885,1593],[1886,1593],[1887,1593],
[1888,1601],[1889,1601],[1890,1705],[1891,1705],[1892,1705],[1893,1605],
[1894,1605],[1895,1606],[1896,1606],[1897,1606],[1898,1604],[1899,1585],
[1900,1585],[1901,1587],[1902,1581],[1903,1581],[1904,1587],[1905,1585],
[1906,1581],[1907,1575],[1908,1575],[1909,1740],[1910,1740],[1911,1740],
[1912,1608],[1913,1608],[1914,1746],[1915,1746],[1916,1581],[1917,1587],
[1918,1587],[1919,1603],[2208,1576],[2209,1576],[2210,1580],[2211,1591],
[2212,1601],[2213,1602],[2214,1604],[2215,1605],[2216,1610],[2217,1610],
[2218,1585],[2219,1608],[2222,1583],[2223,1589],[2224,1711],[2226,1586],
[2544,2480],[2545,2480],[7436,671],[7443,7441],[7532,98],[7533,100],
[7534,102],[7535,109],[7536,110],[7537,112],[7538,114],[7539,114],
[7540,115],[7541,116],[7542,122],[7548,617],[7549,112],[7551,650],
[7552,98],[7553,100],[7554,102],[7555,103],[7556,107],[7557,108],[7558,109],
[7559,110],[7560,112],[7561,114],[7562,115],[7563,643],[7564,118],
[7565,120],[7566,122],[7567,97],[7568,593],[7569,100],[7570,101],[7571,603],
[7572,604],[7573,601],[7574,105],[7575,596],[7576,643],[7577,117],[7578,658],
[7581,7580],[7591,7590],[7592,690],[7593,737],[7594,737],[7596,7504],
[7597,7514],[7603,738],[7605,7511],[7609,7515],[7612,7611],[7613,7611],
[7660,7645],[7661,870],[7664,871],[7666,867],[7667,870],[7668,871],[7680,65],
[7681,97],[7682,66],[7683,98],[7684,66],[7685,98],[7686,66],[7687,98],
[7688,67],[7689,99],[7690,68],[7691,100],[7692,68],[7693,100],[7694,68],
[7695,100],[7696,68],[7697,100],[7698,68],[7699,100],[7700,69],[7701,101],
[7702,69],[7703,101],[7704,69],[7705,101],[7706,69],[7707,101],[7708,69],
[7709,101],[7710,70],[7711,102],[7712,71],[7713,103],[7714,72],[7715,104],
[7716,72],[7717,104],[7718,72],[7719,104],[7720,72],[7721,104],[7722,72],
[7723,104],[7724,73],[7725,105],[7726,73],[7727,105],[7728,75],[7729,107],
[7730,75],[7731,107],[7732,75],[7733,107],[7734,76],[7735,108],[7736,76],
[7737,108],[7738,76],[7739,108],[7740,76],[7741,108],[7742,77],[7743,109],
[7744,77],[7745,109],[7746,77],[7747,109],[7748,78],[7749,110],[7750,78],
[7751,110],[7752,78],[7753,110],[7754,78],[7755,110],[7756,79],[7757,111],
[7758,79],[7759,111],[7760,79],[7761,111],[7762,79],[7763,111],[7764,80],
[7765,112],[7766,80],[7767,112],[7768,82],[7769,114],[7770,82],[7771,114],
[7772,82],[7773,114],[7774,82],[7775,114],[7776,83],[7777,115],[7778,83],
[7779,115],[7780,83],[7781,115],[7782,83],[7783,115],[7784,83],[7785,115],
[7786,84],[7787,116],[7788,84],[7789,116],[7790,84],[7791,116],[7792,84],
[7793,116],[7794,85],[7795,117],[7796,85],[7797,117],[7798,85],[7799,117],
[7800,85],[7801,117],[7802,85],[7803,117],[7804,86],[7805,118],[7806,86],
[7807,118],[7808,87],[7809,119],[7810,87],[7811,119],[7812,87],[7813,119],
[7814,87],[7815,119],[7816,87],[7817,119],[7818,88],[7819,120],[7820,88],
[7821,120],[7822,89],[7823,121],[7824,90],[7825,122],[7826,90],[7827,122],
[7828,90],[7829,122],[7830,104],[7831,116],[7832,119],[7833,121],[7834,97],
[7835,383],[7836,383],[7837,383],[7840,65],[7841,97],[7842,65],[7843,97],
[7844,65],[7845,97],[7846,65],[7847,97],[7848,65],[7849,97],[7850,65],
[7851,97],[7852,65],[7853,97],[7854,65],[7855,97],[7856,65],[7857,97],
[7858,65],[7859,97],[7860,65],[7861,97],[7862,65],[7863,97],[7864,69],
[7865,101],[7866,69],[7867,101],[7868,69],[7869,101],[7870,69],[7871,101],
[7872,69],[7873,101],[7874,69],[7875,101],[7876,69],[7877,101],[7878,69],
[7879,101],[7880,73],[7881,105],[7882,73],[7883,105],[7884,79],[7885,111],
[7886,79],[7887,111],[7888,79],[7889,111],[7890,79],[7891,111],[7892,79],
[7893,111],[7894,79],[7895,111],[7896,79],[7897,111],[7898,79],[7899,111],
[7900,79],[7901,111],[7902,79],[7903,111],[7904,79],[7905,111],[7906,79],
[7907,111],[7908,85],[7909,117],[7910,85],[7911,117],[7912,85],[7913,117],
[7914,85],[7915,117],[7916,85],[7917,117],[7918,85],[7919,117],[7920,85],
[7921,117],[7922,89],[7923,121],[7924,89],[7925,121],[7926,89],[7927,121],
[7928,89],[7929,121],[7934,89],[7935,121],[7936,945],[7937,945],[7938,945],
[7939,945],[7940,945],[7941,945],[7942,945],[7943,945],[7944,913],[7945,913],
[7946,913],[7947,913],[7948,913],[7949,913],[7950,913],[7951,913],[7952,949],
[7953,949],[7954,949],[7955,949],[7956,949],[7957,949],[7960,917],[7961,917],
[7962,917],[7963,917],[7964,917],[7965,917],[7968,951],[7969,951],[7970,951],
[7971,951],[7972,951],[7973,951],[7974,951],[7975,951],[7976,919],[7977,919],
[7978,919],[7979,919],[7980,919],[7981,919],[7982,919],[7983,919],[7984,953],
[7985,953],[7986,953],[7987,953],[7988,953],[7989,953],[7990,953],[7991,953],
[7992,921],[7993,921],[7994,921],[7995,921],[7996,921],[7997,921],[7998,921],
[7999,921],[8000,959],[8001,959],[8002,959],[8003,959],[8004,959],[8005,959],
[8008,927],[8009,927],[8010,927],[8011,927],[8012,927],[8013,927],[8016,965],
[8017,965],[8018,965],[8019,965],[8020,965],[8021,965],[8022,965],[8023,965],
[8025,933],[8027,933],[8029,933],[8031,933],[8032,969],[8033,969],[8034,969],
[8035,969],[8036,969],[8037,969],[8038,969],[8039,969],[8040,937],[8041,937],
[8042,937],[8043,937],[8044,937],[8045,937],[8046,937],[8047,937],[8048,945],
[8049,945],[8050,949],[8051,949],[8052,951],[8053,951],[8054,953],[8055,953],
[8056,959],[8057,959],[8058,965],[8059,965],[8060,969],[8061,969],[8064,945],
[8065,945],[8066,945],[8067,945],[8068,945],[8069,945],[8070,945],[8071,945],
[8072,913],[8073,913],[8074,913],[8075,913],[8076,913],[8077,913],[8078,913],
[8079,913],[8080,951],[8081,951],[8082,951],[8083,951],[8084,951],[8085,951],
[8086,951],[8087,951],[8088,919],[8089,919],[8090,919],[8091,919],[8092,919],
[8093,919],[8094,919],[8095,919],[8096,969],[8097,969],[8098,969],[8099,969],
[8100,969],[8101,969],[8102,969],[8103,969],[8104,937],[8105,937],[8106,937],
[8107,937],[8108,937],[8109,937],[8110,937],[8111,937],[8112,945],[8113,945],
[8114,945],[8115,945],[8116,945],[8118,945],[8119,945],[8120,913],[8121,913],
[8122,913],[8123,913],[8124,913],[8130,951],[8131,951],[8132,951],[8134,951],
[8135,951],[8136,917],[8137,917],[8138,919],[8139,919],[8140,919],[8144,953],
[8145,953],[8146,953],[8147,953],[8150,953],[8151,953],[8152,921],[8153,921],
[8154,921],[8155,921],[8160,965],[8161,965],[8162,965],[8163,965],[8164,961],
[8165,961],[8166,965],[8167,965],[8168,933],[8169,933],[8170,933],[8171,933],
[8172,929],[8178,969],[8179,969],[8180,969],[8182,969],[8183,969],[8184,927],
[8185,927],[8186,937],[8187,937],[8188,937],[11301,11300],[11349,11348],
[11360,76],[11361,108],[11362,76],[11363,80],[11364,82],[11365,97],
[11366,116],[11367,72],[11368,104],[11369,75],[11370,107],[11371,90],
[11372,122],[11374,77],[11377,118],[11378,87],[11379,119],[11380,118],
[11384,101],[11385,633],[11386,111],[11390,83],[11391,90],[42576,1067],
[42577,1099],[42634,1058],[42635,1090],[42798,42796],[42799,42797],
[42810,42808],[42811,42809],[42815,8580],[42816,75],[42817,107],[42818,75],
[42819,107],[42820,75],[42821,107],[42824,76],[42825,108],[42826,79],
[42827,111],[42828,79],[42829,111],[42832,80],[42833,112],[42834,80],
[42835,112],[42836,80],[42837,112],[42838,81],[42839,113],[42840,81],
[42841,113],[42846,86],[42847,118],[42852,222],[42853,254],[42854,222],
[42855,254],[42894,108],[42896,78],[42897,110],[42898,67],[42899,99],
[42900,99],[42901,104],[42902,66],[42903,98],[42904,70],[42905,102],
[42912,71],[42913,103],[42914,75],[42915,107],[42916,78],[42917,110],
[42918,82],[42919,114],[42920,83],[42921,115],[42922,72],[42925,76],
[43000,7476],[43828,101],[43830,609],[43831,108],[43832,108],[43833,108],
[43834,109],[43835,110],[43836,331],[43838,43837],[43839,596],[43841,7444],
[43842,7444],[43844,43843],[43846,640],[43847,114],[43849,114],[43850,43848],
[43852,43851],[43854,117],[43855,649],[43858,117],[43860,43859],[43861,43859],
[43862,120],[43863,120],[43864,120],[43865,120],[43866,121],[43869,737],
[43870,737],[43871,7512],[64285,1497],[64298,1513],[64299,1513],[64300,1513],
[64301,1513],[64302,1488],[64303,1488],[64304,1488],[64305,1489],[64306,1490],
[64307,1491],[64308,1492],[64309,1493],[64310,1494],[64312,1496],[64313,1497],
[64314,1498],[64315,1499],[64316,1500],[64318,1502],[64320,1504],[64321,1505],
[64323,1507],[64324,1508],[64326,1510],[64327,1511],[64328,1512],[64329,1513],
[64330,1514],[64331,1493],[64332,1489],[64333,1499],[64334,1508],[64420,1607],
[64421,1607],[64432,1746],[64433,1746],[64477,1735],[65153,1575],[65154,1575],
[65155,1575],[65156,1575],[65157,1608],[65158,1608],[65159,1575],[65160,1575],
[65161,1610],[65162,1610],[65163,1610],[65164,1610],[113697,113689],
[113698,113690],[113699,113691],[113700,113691],[113701,113692],
[113702,113692],[113711,113705]];
begin
  for i in 1 .. length(str)
  loop
    cp := ascii(substr(str, i, 1));
    if cp < 192
    then
      result := result || substr(str, i, 1);
    else
      first := 1;
      last := array_length(arr_convert, 1);
      found := false;
      while first <= last
      loop
        middle := floor((first + last) / 2);
        val := arr_convert[middle][1];
        if val = cp
        then
          found := true;
          result := result || chr(arr_convert[middle][2]);
          first := last + 1;
        elsif val < cp then first := middle + 1;
        else last := middle - 1;
        end if;
      end loop;
      if not found
      then
        result := result || substr(str, i, 1);
      end if;
    end if;
  end loop;
  return result;
end;
$$ language plpgsql
;
